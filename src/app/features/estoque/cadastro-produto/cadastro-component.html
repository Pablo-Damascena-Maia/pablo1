<div class="inventory-container">
  <div class="inventory-card">
    <h2 class="card-title">Cadastro de Produto em Estoque</h2>

    <div *ngIf="showSuccessMessage" class="success-message">
      <p>Produto cadastrado com sucesso!</p>
    </div>

    <form [formGroup]="productForm" (ngSubmit)="onSubmit()" class="product-form">
      <div class="form-grid">

        <div class="form-group">
          <label for="produtoId">ID do Produto *</label>
          <input type="text" id="produtoId" formControlName="produtoId" [class.invalid]="isFieldInvalid('produtoId')">
          <div *ngIf="hasError('produtoId', 'required')" class="error-message">
            ID do Produto é obrigatório
          </div>
        </div>


        <div class="form-group">
          <label for="quantidade">Quantidade *</label>
          <input type="number" id="quantidade" formControlName="quantidade" [class.invalid]="isFieldInvalid('quantidade')" min="0">
          <div *ngIf="hasError('quantidade', 'required')" class="error-message">
            Quantidade é obrigatória
          </div>
        </div>


        <div class="form-group">
          <label for="minimo">Estoque Mínimo *</label>
          <input type="number" id="minimo" formControlName="minimo" [class.invalid]="isFieldInvalid('minimo')" min="0">
          <div *ngIf="hasError('minimo', 'required')" class="error-message">
            Estoque mínimo é obrigatório
          </div>
        </div>

        <div class="form-group">
          <label for="dataValidade">Data de Validade *</label>
          <input type="date" id="dataValidade" formControlName="dataValidade" [class.invalid]="isFieldInvalid('dataValidade')">
          <div *ngIf="hasError('dataValidade', 'required')" class="error-message">
            Data de validade é obrigatória
          </div>
          <div *ngIf="hasError('dataValidade', 'invalidDate')" class="error-message">
            A data deve ser maior que hoje
          </div>
        </div>


        <div class="form-group">
          <label for="tipo">Tipo *</label>
          <select id="tipo" formControlName="tipo" [class.invalid]="isFieldInvalid('tipo')">
            <option *ngFor="let tipo of produtoTipos" [value]="tipo.value">
              {{ tipo.label }}
            </option>
          </select>
          <div *ngIf="hasError('tipo', 'required')" class="error-message">
            Tipo é obrigatório
          </div>
        </div>


        <div class="form-group">
          <label for="status">Status *</label>
          <select id="status" formControlName="status" [class.invalid]="isFieldInvalid('status')">
            <option value="ativo">Ativo</option>
            <option value="inativo">Inativo</option>
            <option value="em_manutencao">Em Manutenção</option>
          </select>
          <div *ngIf="hasError('status', 'required')" class="error-message">
            Status é obrigatório
          </div>
        </div>


        <div class="form-group">
          <label for="valorCompra">Valor de Compra (R$) *</label>
          <input type="number" step="0.01" id="valorCompra" formControlName="valorCompra" [class.invalid]="isFieldInvalid('valorCompra')" min="0">
          <div *ngIf="hasError('valorCompra', 'required')" class="error-message">
            Valor de compra é obrigatório
          </div>
          <div *ngIf="hasError('valorCompra', 'min')" class="error-message">
            Valor de compra não pode ser negativo
          </div>
        </div>

        <div class="form-group">
          <label for="valorVenda">Valor de Venda (R$) *</label>
          <input type="number" step="0.01" id="valorVenda" formControlName="valorVenda" [class.invalid]="isFieldInvalid('valorVenda')" min="0">
          <div *ngIf="hasError('valorVenda', 'required')" class="error-message">
            Valor de venda é obrigatório
          </div>
          <div *ngIf="hasError('valorVenda', 'min')" class="error-message">
            Valor de venda não pode ser negativo
          </div>
        </div>


        <div class="form-group">
          <label for="fornecedorId">ID do Fornecedor *</label>
          <input type="text" id="fornecedorId" formControlName="fornecedorId" [class.invalid]="isFieldInvalid('fornecedorId')">
          <div *ngIf="hasError('fornecedorId', 'required')" class="error-message">
            ID do fornecedor é obrigatório
          </div>
        </div>
      </div>

      <div class="form-actions">
        <button type="button" class="btn-secondary" (click)="onReset()">Limpar</button>
        <button type="submit" class="btn-primary" [disabled]="isSubmitting">
          {{ isSubmitting ? 'Salvando...' : 'Cadastrar Produto' }}
        </button>
      </div>
    </form>
  </div>
</div>